<!DOCTYPE html>
<html>
<head>
    <title>TDD and OOP workshop</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <style type="text/css">
        @import url(https://fonts.googleapis.com/css?family=Yanone+Kaffeesatz);
        @import url(https://fonts.googleapis.com/css?family=Droid+Serif:400,700,400italic);
        @import url(https://fonts.googleapis.com/css?family=Ubuntu+Mono:400,700,400italic);

        body {
            font-family: 'Droid Serif';
        }

        h1, h2, h3 {
            font-family: 'Yanone Kaffeesatz';
            font-weight: normal;
        }

        .inverse {
            color: white;
            text-shadow: 0 0 20px #333;
        }

        .inverse h1, .inverse h2 {
            color: #f3f3f3;
            line-height: 0.8em;
        }

        .footnote {
            position: absolute;
            bottom: 3em;
        }

        /* Two-column layout */
        .left-column {
            width: 45%;
            height: 92%;
            float: left;
            padding-right: 1em;
        }

        .left-column h2:last-of-type, .left-column h3:last-child {
            color: #000;
        }

        .right-column {
            width: 45%;
            float: right;
            padding-left: 1em;
        }

        .remark-code, .remark-inline-code {
            font-family: 'Ubuntu Mono';
        }
    </style>
</head>
<body>
<textarea id="source">

name: inverse
layout: true
class: inverse

---
layout: false
background-image: url(img/title-screen-background.png)
background-size: contain
background-repeat: no-repeat
background-position: bottom
class: center top

# TDD with OOP workshop



---

##\#whoami


In IT since 2006, in Java since 2014

Practice TDD since then

In Vattenfall since 2016

TODO: solution architect?

Currently developer and solution architect in eMobility

From time to time speaker at community events and conferences
---

##\#whoareyou

Introduction round, let's share our....

Name

Occupation

Experience

TDD & OOP familiarity

Expectations

---
##Organization/contract

We are not in school

Lunch break

Coffee breaks

Let's treat breaks' endings strictly
---
##Agenda

1. TDD
    - basics
    - test doubles
    - test approaches
    - integration and unit tests
    - tests as design tool

2. OOP
    - basics
    - SOLID
    - Cohesion and coupling

3. Bigger (most probably vending machine) *kata*


---
##TDD

What is it about?

Are you doing it?

Have you tried it?

Is it hard?

Is it beneficial?
---
##Feedback loops

How fast do you want to know that software is working?

How fast is *fast*?

Automatic tests for the rescue, but they must be *fast*

Long feedback loops kills focus

---
##Feedback loops

TODO: image
---
##Testing

What good test should do?

What features good test has?
---
##Test Driven Development

Red -> Green -> Refactor

TODO: image
---
##Test Driven Development

You are not allowed to write any production code unless it is to make a failing unit test pass.

You are not allowed to write any more of a unit test than is sufficient to fail; and compilation failures are failures.

You are not allowed to write any more production code than is sufficient to pass the one failing unit test.

---
##Test Driven Development

Why to start with test?

*Clean code that works* (by Ron Jeffries)

Very small steps

Control of increments, small ones in a disciplined manner

No (or very little) untested code in codebase

---
##Test structure

_Given_

Test setup - initial conditions

_When_

Bahaviour under test

_Then_

Verification of behaviour, assertion

---
##Test Driven Development - exercise


---
##Testing approaches

Black box

White box
---
##Blackbox testing

Focused on behaviour

Couples with behaviour (test changes, when behaviour changes)

Ignores implementation details
---
##Whitebox testing

Assumes knowledge of implementation details

Couples with implementation (test changes, when implementation changes)

---
##Testing approaches pros/cons

Black box

White box

What do you think?

---
##Types of tests

Unit

Integration

---
##Unit tests

What is a unit?

A class?

A method?

Testing private methods?

A cluster of objects?

A behaviour?

---
##Integration tests

I/O integration

What I/O is?
---
##Test doubles

Way of testing interactions with collaborators
---
##Test pyramid

TODO: image

---
##Qualities of good tests

Minimize programmer waiting.

Run reliably.

Predict deployability.

Respond to behavior changes.

Not respond to structure changes.

Be cheap to write.

Be cheap to read.

Be cheap to change.

---
###FIRST

Fast

Isolated/independent

Repeatable

Self-validating

Thorough/Timely

---
##TDD benefits

Enforces slice, by slice, step by step approach

Safety and comfort

Drives development

Documentation

---
##Where TDD might not help?

HTML rendering


---

##Tools

Spock Framework

JUnit, plenty of assertions tools e.g. AssertJ

---
##Test doubles

Fake

Mocks

Stubs

Spy

Dummy

---
##Fake

Working implementations

Not suitable for production

Map, HashMap, Collection etc. used as in-memory DB

---
##Mocks

Specification of the calls they are expected to receive

Can throw an exception if they receive a call they don't expect

Checked during verification to ensure they got all the calls they were expecting

---
##Stubs

Provide canned answers to calls made during the test

---
##Spy

Stubs that also record some information based on how they were called

Stubs + mocks

One form of this might be an email service that records how many messages it was sent

---
##Dummy

Passed around but never actually used

Used to fill parameter lists

Avoidance of Null Pointer Exception

---
## Mocking

Problems

TODO: code samples, and exercise
---
##Mocking tools

Spock Framework

Mockito for JUnit

---
##Parametrized tests

Spock Framework

JUnitParams for JUnit

---

##TDD and existing code

Fixing a bug

Add test reproducing the bug

Fix it

---

##TDD and existing code

Refactoring

Cover with tests

Refactor safely and without stress


---
##TDD as design tool

Is TDD design tool itself?

Navigates through designing

Enforces (re)design step

Doesn't tell *how* to design

---

##Object Oriented Programming (OOP)

Core concepts:

Encapsulation

Polymorphism

Inheritance

---
##OOP - encapsulation/information hiding

Hidden implementation details

Scalable at multiple levels

Setters/getters

TODO: Demeter law
TODO: code sample

---
##OOP - tell don't ask

TODO: code sample

---

##OOP - encapsulation at scale

Modules

Microservices
---

##OOP - inheritance

Doesn't work

Why? Let's see :)

TODO: broken encapsulation, high coupling, code sample

---
##OOP - polymorphism

Interface and implementation(naming)

Strategy/state design pattern

Naming conventions?

---
##OOP in practice

What does Object Oriented language mean?

Is Java an OO language?

If no, what should be changed?

Is '''class''' keyword enough to be OO?

---
##OOP in practice - heuristics

SOLID

Cohesion - coupling


---
##SOLID

SRP

OCP

LSP

ISP

DIP

---

##SRP

Single Responsibility Principle

"Do one thing"

"One reason to change"

Sounds quite academic

Do event authors understant it?

---
##OCP

Open Closed Principle

"Open for extensions, closed for modification"

What design patterns styles support it?

DI

IOC

Interfaces

Events

Higher order functions

---
##LSP

Substitution of interfaces' implementation must be possible

Focus on behaviour

How code must be tested to ensure it?

---
##ISP

Interface segregation principle

API width


---
##DIP

Client should depend on abstraction not implementation

Should everything have interface?
---
##Cohesion and coupling

WTF are they?

---
##Cohesion

TODO: sample
---
##Coupling

TODO: sample
---
##High cohesion low coupling

Probably most important design rule in IT development

OOP

DDD

Modules

Microservices

---
##High cohesion low coupling


TODO: sample

---

##TDD and OOP - testing and design

An *Unit* can be quite flexible

Java has default access - so called package private

How about this: public facade serving as an API
---
##TDD and design

Does TDD itself lead to good design?

Helps a lot, but...

At least some overview design might be useful

Bad testability usually is a marker of bad design

---
Vending machine kata

---
That's all folks
        TODO: image from looney toons

    </textarea>
<script src="https://gnab.github.io/remark/downloads/remark-latest.min.js" type="text/javascript"></script>
<script type="text/javascript">
    var slideshow = remark.create({
        countIncrementalSlides: false
    });
</script>
</body>
</html>
